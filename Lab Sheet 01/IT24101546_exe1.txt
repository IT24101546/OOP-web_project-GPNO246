--(a)--
create view showDetails_it24101546
AS
select s.movieTitle,s.theaterName,t.city, t.country
from Show s, Theater t
where s.theaterName = t.theaterName and s.spectators = t.capacity

select * from showDetails_it24101546

drop view showDetails_it24101546

--(b)--
create view showDetails_it24101546(Name,Country,NumberofMovies)
as
select ms.name, ms.country, COUNT(s.movieTitle)
from MovieStar ms, StarsIn s
where ms.name = s.starname
group by ms.name, ms.country

select * from showDetails_it24101546

drop view showDetails_it24101546

--(c)--
create function DisplayTotalEarnings_it24101546(@mtitel varchar(20)) returns int
as
begin 
declare @tot_earnings int
select @tot_earnings = sum(s.ticketPrice*s.spectators)
from Show s
where s.movieTitle = @mtitel
return @tot_earnings
end;

declare @ernings int
exec @ernings = DisplayTotalEarnings_it24101546 'Spider-man'
print @ernings

--(d)--
create function DisplayRemainingSeates_it24101546(@show int) returns int
as 
begin
declare @remainingSeats int 
select @remainingSeats = t.capacity - s.spectators
from Show s, Theater t
where s.theaterName = t.theaterName and s.showId = @show
return @remainingSeats
end;

declare @resutl int
exec @resutl = DisplayRemainingSeates_it24101546 3
print @resutl 

